# 比价助手部署指南

本项目为纯静态站点（HTML/CSS/JS），无需构建即可上线。下面给出两种稳定的上线方式：GitHub Pages 与 Netlify。若仅需临时分享，可使用本地预览 + 隧道方式。

## 方案一：GitHub Pages（推荐）

前提：本机已安装 Git，且你有 GitHub 账号。

1. 在 GitHub 新建仓库（建议名称：`bj-helper` 或中文名）。
2. 将本项目 `比价助手/` 目录内容作为仓库根目录上传（保证 `index.html` 在仓库根）。
3. 本地推送示例命令（在 `比价助手` 目录内执行）：

   ```bash
   git init
   git add .
   git commit -m "Deploy 比价助手 v1"
   git branch -M main
   git remote add origin https://github.com/<你的用户名>/<你的仓库名>.git
   git push -u origin main
   ```

4. 在 GitHub 仓库 Settings → Pages：
   - Source 选择 `Deploy from a branch`
   - Branch 选择 `main`，Folder 选择 `/ (root)`
   - 保存后等待几分钟，站点地址通常为：`https://<你的用户名>.github.io/<你的仓库名>/`

注意事项：
- 本项目使用 Service Worker 做资源缓存。每次有前端改动，记得在 `sw.js` 中提升 `CACHE_NAME`（如 `bj-cache-v8` → `bj-cache-v9`），并同步 `index.html` 的脚本版本号（如 `script.js?v=4`）。这能确保用户刷新后拿到新版本。
- 若你使用用户主页仓库（`<用户名>.github.io`），仓库根即站点根，路径更简单；项目主页仓库（`/<仓库名>/`）也可直接用相对路径部署，本项目已采用相对路径，兼容两者。
- 如果你要使用本地 JSON 数据源，请在仓库根创建 `data/` 文件夹，内放 `slug` 格式命名的 JSON 文件（如 `iphone-15-pro.json`），内容为报价数组，详见 `sources.js` 注释。

## 方案二：Netlify（零配置拖拽）

1. 进入 https://app.netlify.com/，登录后点击 “Add new site” → “Deploy manually”。
2. 打包并上传 `比价助手` 目录（包含 `index.html`、`styles.css`、`script.js`、`sources.js`、`manifest.json`、`sw.js` 以及可选的 `data/`）。
3. 部署后生成的站点域名可直接访问；如需自定义域名可在 Netlify 设置中绑定。

若使用 Netlify CLI（可选）：

```bash
npm i -g netlify-cli
netlify init        # 按提示登录并选择站点
netlify deploy --prod --dir=.
```

## 临时分享：本地预览 + 隧道（ngrok）

当前已在本地运行预览服务器：`http://localhost:8000/`（Trae IDE内）。如需对外临时访问：

1. 安装 ngrok（或使用你已有的 `ngrok`）：
   ```bash
   brew install ngrok
   ngrok config add-authtoken <你的authtoken>
   ```
2. 在项目根运行：
   ```bash
   ngrok http 8000
   ```
3. 复制 ngrok 提供的公开链接分享即可。注意：免费版隧道可能会有时长或带宽限制。

## 上线后检查清单

- 页面是否能正常加载、搜索与自动比较是否工作正常。
- “拍照识别”按钮是否可用（需要 HTTPS，GitHub Pages/Netlify 默认支持）。
- Service Worker 是否注册成功：浏览器开发者工具 → Application → Service Workers。
- 若更新后页面无变化：强制刷新（Cmd+Shift+R）或在 Application 中 `Unregister` Service Worker 再刷新。

## 常见问题

- 路径问题：我们使用相对路径（如 `./index.html`、`./script.js?v=4`），以兼容 GitHub Pages 的项目页路径（`/<repo>/`）。若你迁移到不同目录结构，请保持文件相对关系不变。
- 缓存更新：前端改动后未生效，多半是浏览器/Service Worker 缓存。提升 `CACHE_NAME` 并更新资源版本号，然后强制刷新。

如需我为你新建仓库并准备一次性推送脚本（含远程地址占位），或改为 Netlify 自动化部署配置（build hooks / CLI），告诉我你倾向的方案与仓库名即可。